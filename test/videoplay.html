<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Display Videos</title>
    <script src="https://www.youtube.com/iframe_api"></script>
</head>
<body>

    <h2>Videos</h2>

    <div id="videosContainer"></div>

    <script>
        // YouTube API ready function
        function onYouTubeIframeAPIReady() {
            // Fetch video data from the server
            fetch('http://localhost:3000/api/getlectures')
                .then(response => response.json())
                .then(videos => {
                    // Render videos on the page
                    const videosContainer = document.getElementById('videosContainer');
                    videos.forEach(video => {
                        // Extract video ID from YouTube URL
                        const videoId = extractVideoId(video.videoUrl);

                        // Create video element
                        const videoElement = document.createElement('div');
                        videoElement.innerHTML = `
                            <h3>${video.title}</h3>
                            <p>${video.description}</p>
                            <div id="player-${video.id}"></div>
                        `;
                        videosContainer.appendChild(videoElement);

                        // Create YouTube player
                        const player = new YT.Player(`player-${video.id}`, {
                            height: '315',
                            width: '560',
                            videoId: videoId,
                            events: {
                                // You can add event handlers here if needed
                            }
                        });

                        // Attach event listener to title for playing video
                        const titleElement = videoElement.querySelector('h3');
                        titleElement.addEventListener('click', () => playVideo(player));
                    });
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Failed to load videos. Please try again.'); // Show error message
                });
        }

        // Function to extract video ID from YouTube URL
     // Function to extract video ID from YouTube URL
function extractVideoId(url) {
    if (!url) return null; // Check if URL is provided
    const match = url.match(/[?&]v=([^?&]+)/);
    return match ? match[1] : null;
}


        // Function to play/pause video
        function playVideo(player) {
            if (player.getPlayerState() === YT.PlayerState.PLAYING) {
                player.pauseVideo();
            } else {
                player.playVideo();
            }
        }
    </script>

</body>
</html>
